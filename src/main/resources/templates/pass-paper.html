<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Leets 면접 안내</title>
  </head>
  <body>
    <div style="background-color: rgb(255, 255, 255)">
      <table
        id="main-table"
        style="
          width: 100%;
          max-width: 536px;
          margin: 0px auto;
          background-color: rgba(46, 183, 156, 0.5);
          font-size: 30px;
          color: rgb(255, 255, 255);
          padding-left: 2px;
        "
      >
        <tr>
          <td style="padding: 20px">
            <img
              id="logo-image"
              src="https://i.imgur.com/BdNQJne.png"
              alt="logo"
              style="
                width: 39px;
                height: 25px;
                vertical-align: middle;
                fill: rgb(46, 183, 156);
              "
            />
            Leets
          </td>
        </tr>
      </table>
      <table
        id="bg-image"
        style="
          width: 100%;
          max-width: 536px;
          margin: 0px auto;
          text-align: center;
          margin-top: 50px;
          background-image: url('https://i.imgur.com/FdUhMw0.png');
          background-size: 218.76px 129.26px;
          background-repeat: no-repeat;
          background-position: center 35%;
        "
      >
        <tr>
          <td
            style="
              color: black;
              font-size: 14.5px;
              font-weight: 700;
              padding: 20px;
              position: relative;
              text-align: left;
              margin-bottom: 30px;
            "
          >
            <span th:text="${name}"></span>님 안녕하세요. Leets 2기 면접 담당자입니다.
            <br>
            Leets 2기에 지원해 주셔서 감사드립니다.
            <br><br><br>
            먼저, Leets 2기 서류 합격을 진심으로 축하드립니다!
            <br>
            <span th:text="${name}"></span>님께서 작성해주신 지원서 내용을 면밀히 살펴보고
            <br>
            운영진들의 내부 평가를 거친 결과,
            <br>
            <span th:text="${name}"></span>님과 면접에서 더 자세히 이야기를 나눠 보고 싶다는 결론이 나왔습니다.
            <br><br>
            <span th:text="${name}"></span>님의 면접 날짜는 아래와 같습니다.
            <br>
            일시 : <span th:text="${fixedInterviewDate}"></span><br>
            장소 : AI 공학관 312호
            <br><br>
            면접을 희망 하신다면, 아래의 면접 지원 버튼을 클릭 해주세요.
            <br>
            면접 날짜 또는 시간 변경 문의 및 문의 사항은 아래의
            오픈채팅으로<br>연락 주시면 감사하겠습니다.
            <br><br>서류 합격을 다시 한 번 축하 드리며, 면접에서 뵐 수 있길 기대하겠습니다.
          </td>
        </tr>
        <tr>
          <td style="text-align: center">
            <a
              id="apply-button"
              href=""
              style="
                display: inline-block;
                width: 208px;
                height: 64px;
                border-radius: 40px;
                background-color: rgb(46, 183, 156);
                color: white;
                font-size: 16px;
                line-height: 64px;
                text-decoration: none;
                font-weight: 800;
                margin-top: 80px;
                margin-bottom: 30px;
              "
              onclick="submitApplication()"
            >
              면접 지원하기
            </a>
          </td>
        </tr>
        <tr>
          <td
            style="
              text-align: center;
              color: rgb(78, 78, 78);
              font-size: 14.5px;
            "
          >
            <div style="margin-bottom: 8px">
              오픈채팅:
              <a href="https://open.kakao.com/o/sObD2U5e"
                >https://open.kakao.com/o/sObD2U5e</a
              >
            </div>
          </td>
        </tr>
      </table>
    </div>

    <script>
      fetch("/api/getData")
        .then((response) => response.json())
        .then((data) => {
          document.getElementById("name").textContent = data.name;
          document.getElementById("interviewDate").textContent =
            data.interviewDate;
          document.getElementById("interviewLocation").textContent =
            data.interviewLocation;

          const table = document.querySelector("#main-table");
          table.style.backgroundColor = data.backgroundColor;

          const bgtable = document.querySelector("#bg-image");
          const backgroundImage = `url('${data.backgroundImageUrl}')`;
          bgtable.style.backgroundImage = backgroundImage;

          const logoImage = document.querySelector("#logo-image");
          logoImage.src = data.logoImageUrl;

          const applyButton = document.querySelector("#apply-button");
          applyButton.style.backgroundColor = data.buttonBackgroundColor;
        })
        .catch((error) => console.error("Error:", error));

      function submitApplication() {
        fetch("/api/submitApplication", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify({ interviewWish: true }),
        })
          .then((response) => response.json())
          .then((data) => {
            if (data.success) {
              alert("면접 희망 여부가 업데이트되었습니다.");
            } else {
              alert("면접 희망 여부 업데이트에 실패했습니다.");
            }
          })
          .catch((error) => {
            console.error("Error:", error);
            alert("면접 희망 여부 업데이트 중 오류가 발생했습니다.");
          });
      }
    </script>
  </body>
</html>
